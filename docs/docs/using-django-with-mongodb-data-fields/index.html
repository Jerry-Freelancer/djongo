<!DOCTYPE html><html lang="en" class="no-js" data-beasties-container><head>
  <meta charset="UTF-8">
  <title>Using Djongo Model fields</title>
  <meta name="description" content="Djongo is a smarter approach to database querying. It maps python objects to MongoDB documents. It is popularly referred to as an Object Document Mapper or ODM. It is an extension to the traditional Django object relational modeling framework. Use Django Admin to directly add and modify documents stored in MongoDB. Use other contrib modules such as Auth and Sessions without any changes.">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="en_US">
  <meta property="og:site_name" content="Djongomapper">
  <meta property="og:title" content="Djongo">
  <meta property="og:url" content="https://www.djongomapper.com/">
  <meta property="og:description" content="Djongo is a smarter approach to database querying. It maps python objects to MongoDB documents. It is popularly referred to as an Object Document Mapper or ODM. It is an extension to the traditional Django object relational modeling framework. Use Django Admin to directly add and modify documents stored in MongoDB. Use other contrib modules such as Auth and Sessions without any changes.">
  <link rel="canonical" href="https://www.djongomapper.com/">
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Doableware",
      "url": "https://www.djongomapper.com/",
      "logo": "/assets/images/djongo-symbol-small.png"
    }
  </script>
  <meta name="google-site-verification" content="tFNu7Nc9hzKF9v7f6kYaoMbBCNyGREchcKMVdxJuyJo">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script>
    document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  </script>
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  </noscript>
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/custom.css">
  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <script async src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script async src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
  <!--<script async src="/assets/js/cookie-consent.js"></script>-->

  <script>
    if (window.location.hostname != 'localhost') {
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
                    'gtm.start':
                      new Date().getTime(), event: 'gtm.js'
                  });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src =
          'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, 'script', 'dataLayer', 'GTM-T72KG6N');
    }
  </script>

  <base href="/">
<style>html{scroll-behavior:smooth}
</style><link rel="stylesheet" href="styles-TPMX36DN.css" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles-TPMX36DN.css"></noscript><style ng-app-id="ng">.body[_ngcontent-ng-c3825049082]{display:grid;grid-template-columns:minmax(min-content,calc(300px - 1rem)) minmax(256px,1280px) minmax(min-content,calc(300px - 1rem));grid-template-rows:calc(100vh - 3rem) auto;justify-content:center;gap:1rem;padding-left:1rem;padding-right:1rem}.body[_ngcontent-ng-c3825049082] > div[_ngcontent-ng-c3825049082]{grid-row:1/-1}.body[_ngcontent-ng-c3825049082] > aside[_ngcontent-ng-c3825049082]{grid-row:1}.nav[_ngcontent-ng-c3825049082]{padding-top:1rem;padding-bottom:1rem;font-size:.7rem}.nav-sticky[_ngcontent-ng-c3825049082]{position:sticky;top:3rem;overflow:auto}.nav-side[_ngcontent-ng-c3825049082]   h3[_ngcontent-ng-c3825049082]{font-size:.7rem;opacity:.7;text-transform:uppercase;border-bottom:1px solid #f2f3f3;margin:.5rem 0;padding:.25rem 0}.nav-side[_ngcontent-ng-c3825049082]   a[_ngcontent-ng-c3825049082]{color:inherit;opacity:.7}.nav-side[_ngcontent-ng-c3825049082]   .active[_ngcontent-ng-c3825049082]{font-weight:700;opacity:1}.nav-side[_ngcontent-ng-c3825049082]   a[_ngcontent-ng-c3825049082]:hover{opacity:1}.nav-toc[_ngcontent-ng-c3825049082]   h3[_ngcontent-ng-c3825049082]{font-size:.75rem;font-weight:700;color:#fff;background:#6f777d;border-top-left-radius:4px;border-top-right-radius:4px;padding:.5rem .75rem;margin:0}.nav-toc[_ngcontent-ng-c3825049082]   a[_ngcontent-ng-c3825049082]{display:block;padding:.25rem .75rem;color:#646769;font-weight:700;line-height:1.5;border-bottom:1px solid #f2f3f3;border-left:1px solid #f2f3f3;border-right:1px solid #f2f3f3}.nav-toc[_ngcontent-ng-c3825049082]   a[_ngcontent-ng-c3825049082]:hover{text-decoration:underline}.nav-toc[_ngcontent-ng-c3825049082]   li[_ngcontent-ng-c3825049082]   li[_ngcontent-ng-c3825049082] > a[_ngcontent-ng-c3825049082]{font-weight:400;padding-left:1rem}.nav-toc[_ngcontent-ng-c3825049082]   .active[_ngcontent-ng-c3825049082]{background-color:#e2e4e5}.sidebar[_ngcontent-ng-c3825049082]{opacity:1}.sidebar[_ngcontent-ng-c3825049082]   li[_ngcontent-ng-c3825049082]{font-size:.7rem}.page__content[_ngcontent-ng-c3825049082]{margin-top:1em}</style><style ng-app-id="ng">.close[_ngcontent-ng-c3552946287]{height:0;transition:height 2s}.mast[_ngcontent-ng-c3552946287]{position:sticky;top:0;padding:.5em 0;z-index:1;background:#fff;border-bottom:1px solid #f2f3f3}.mast[_ngcontent-ng-c3552946287] > div[_ngcontent-ng-c3552946287]{margin:0 auto;max-width:1280px;display:flex;flex-direction:row;justify-content:space-between}.mast[_ngcontent-ng-c3552946287]   a[_ngcontent-ng-c3552946287]{display:block;color:#6f777d;text-decoration:none}.mast[_ngcontent-ng-c3552946287]   .mast-logo[_ngcontent-ng-c3552946287]{display:flex}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   ul[_ngcontent-ng-c3552946287]{display:flex;align-items:center}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   ul.media-small[_ngcontent-ng-c3552946287]{flex-direction:column}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   a[_ngcontent-ng-c3552946287]{margin:0 .75rem}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   .nav-link[_ngcontent-ng-c3552946287]{position:relative}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   .nav-link[_ngcontent-ng-c3552946287]:hover:after{width:100%}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   .nav-link[_ngcontent-ng-c3552946287]:after{content:"";position:absolute;left:50%;bottom:0;transform:translate(-50%);width:0;height:4px;background-color:#6f777d;transition:width .2s ease-in-out}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   .nav-btn[_ngcontent-ng-c3552946287]{padding:.5em 1em;font-size:.75em;font-weight:700;text-align:center;border-width:0;border-radius:4px;color:#fff}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   .btn-red[_ngcontent-ng-c3552946287]{background-color:#ee5f5b}.mast[_ngcontent-ng-c3552946287]   .mast-nav[_ngcontent-ng-c3552946287]   .btn-red[_ngcontent-ng-c3552946287]:hover{background-color:#b2231f}</style><style ng-app-id="ng">.media-small[_ngcontent-ng-c2376829457]{position:fixed;top:3rem;left:0;padding:0 1rem;background:#fff;height:100vh}.cross[_ngcontent-ng-c2376829457]{margin:.6rem 0}.cross[_ngcontent-ng-c2376829457]:hover{cursor:pointer}.cross[_ngcontent-ng-c2376829457] > div[_ngcontent-ng-c2376829457]{background:#000;height:1px;width:1.2rem}.cross[_ngcontent-ng-c2376829457] > div[_ngcontent-ng-c2376829457]:nth-child(1){transform:translateY(1px) rotate(45deg)}.cross[_ngcontent-ng-c2376829457] > div[_ngcontent-ng-c2376829457]:nth-child(2){transform:rotate(-45deg)}.open[_ngcontent-ng-c2376829457]{transition:width .4s}.close[_ngcontent-ng-c2376829457]{width:0;padding:0;overflow:hidden;transition:width .3s}</style></head>
<body><!--nghm--><script type="text/javascript" id="ng-event-dispatch-contract">(()=>{function p(t,n,r,o,e,i,f,m){return{eventType:t,event:n,targetElement:r,eic:o,timeStamp:e,eia:i,eirp:f,eiack:m}}function u(t){let n=[],r=e=>{n.push(e)};return{c:t,q:n,et:[],etc:[],d:r,h:e=>{r(p(e.type,e,e.target,t,Date.now()))}}}function s(t,n,r){for(let o=0;o<n.length;o++){let e=n[o];(r?t.etc:t.et).push(e),t.c.addEventListener(e,t.h,r)}}function c(t,n,r,o,e=window){let i=u(t);e._ejsas||(e._ejsas={}),e._ejsas[n]=i,s(i,r),s(i,o,!0)}window.__jsaction_bootstrap=c;})();
</script><script>window.__jsaction_bootstrap(document.body,"ng",["click"],[]);</script>
<app-root ng-version="19.2.0" ngh="4" ng-server-context="ssg"><router-outlet></router-outlet><ng-component _nghost-ng-c3825049082 ngh="3"><app-body _ngcontent-ng-c3825049082 _nghost-ng-c3552946287 ngh="0"><div _ngcontent-ng-c3552946287 class="layout--splash"><div _ngcontent-ng-c3552946287 class="mast"><div _ngcontent-ng-c3552946287><div _ngcontent-ng-c3552946287 class="mast-logo"><a _ngcontent-ng-c3552946287 href="/" class="site-logo"><img _ngcontent-ng-c3552946287 src="/assets/images/djongo-symbol-small.png" alt="Djongo"></a></div><div _ngcontent-ng-c3552946287 class="mast-nav"><nav _ngcontent-ng-c3552946287><ul _ngcontent-ng-c3552946287><li _ngcontent-ng-c3552946287><a _ngcontent-ng-c3552946287 class="btn-red nav-btn" href="/djongocs/login" jsaction="click:;">Login</a></li><li _ngcontent-ng-c3552946287><a _ngcontent-ng-c3552946287 class="btn--primary nav-btn" href="/djongocs/contact-us" jsaction="click:;">Contact Us</a></li><li _ngcontent-ng-c3552946287><a _ngcontent-ng-c3552946287 class="nav-link" href="/app-development" jsaction="click:;">Services</a></li><li _ngcontent-ng-c3552946287><a _ngcontent-ng-c3552946287 class="nav-link" href="/products" jsaction="click:;">Products</a></li><li _ngcontent-ng-c3552946287><a _ngcontent-ng-c3552946287 class="nav-link" href="/docs/get-started" jsaction="click:;">Docs</a></li><!----></ul></nav></div></div></div><div _ngcontent-ng-c3552946287 class="initial-content"><div _ngcontent-ng-c3825049082 class="body"><aside _ngcontent-ng-c3825049082 class="nav-sticky"><app-nav _ngcontent-ng-c3825049082 _nghost-ng-c2376829457 ngh="1"><!----><nav _ngcontent-ng-c3825049082 class="nav nav-side"><ul _ngcontent-ng-c3825049082><li _ngcontent-ng-c3825049082><h3 _ngcontent-ng-c3825049082>Djongo</h3><ul _ngcontent-ng-c3825049082><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/get-started" class jsaction="click:;"> Get Started </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/integrating-django-with-mongodb" class jsaction="click:;"> Django with MongoDB </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/using-django-with-mongodb-data-fields" class="active" jsaction="click:;"> Embedded Field </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/using-django-with-mongodb-array-field" class jsaction="click:;"> Array Field </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/using-django-with-mongodb-array-reference-field" class jsaction="click:;"> Array Reference Field </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/using-django-with-other-fields" class jsaction="click:;"> Other Fields </a></li><!----></ul></li><li _ngcontent-ng-c3825049082><h3 _ngcontent-ng-c3825049082>DjongoCS</h3><ul _ngcontent-ng-c3825049082><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/indexes" class jsaction="click:;"> Indexes </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/model-query" class jsaction="click:;"> Model Query </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/model-creation" class jsaction="click:;"> Model Creation </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/model-update" class jsaction="click:;"> Model Update </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/database-transactions" class jsaction="click:;"> Database Transactions </a></li><!----></ul></li><li _ngcontent-ng-c3825049082><h3 _ngcontent-ng-c3825049082>Side Stuff</h3><ul _ngcontent-ng-c3825049082><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/djongo-comparison" class jsaction="click:;"> Djongo vs Others </a></li><li _ngcontent-ng-c3825049082><a _ngcontent-ng-c3825049082 routerlinkactive="active" href="/docs/django-mongodb-connector-design-document" class jsaction="click:;"> Djongo Design </a></li><!----></ul></li><!----></ul></nav><!----><!----><!----></app-nav></aside><div _ngcontent-ng-c3825049082 class="page__content"><header _ngcontent-ng-c3825049082><h1 _ngcontent-ng-c3825049082 class="page__title">Using Djongo Model fields</h1></header><router-outlet _ngcontent-ng-c3825049082></router-outlet><ng-component ngh="2"><h2 id="embeddedfield">EmbeddedField</h2><p>MongoDB allows the creation of an <a href="https://docs.mongodb.com/manual/core/data-model-design/#data-modeling-embedding">embedded document</a>. By using Djongo as your connector, you can embed any other 'model' into your parent model through the <code>EmbeddedField</code>. </p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">EmbeddedField</span><span class="p">(</span><span class="n">MongoField</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">model_container</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="n">Model</span><span class="p">],</span>
                 <span class="n">model_form_class</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">model_form_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</code></pre></div><h3 id="arguments">Arguments</h3><table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>model_container</code></td><td><code>models.Model</code></td><td>The child model class type (not instance) that this embedded field will contain.</td></tr><tr><td><code>model_form_class</code></td><td><code>models.forms.ModelForm</code></td><td>The child model form class type of the embedded model.</td></tr><tr><td><code>model_form_kwargs</code></td><td><code>dict()</code></td><td>The kwargs (if any) that must be passed to the <code>forms.ModelForm</code> while instantiating it.</td></tr></tbody></table><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">djongo</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ObjectIdField</span><span class="p">()</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span>
    <span class="p">)</span>

    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DjongoManager</span><span class="p">()</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">headline</span><span class="o">=</span><span class="s1">'h1'</span><span class="p">,</span>
    <span class="n">blog</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'b1'</span><span class="p">,</span>
        <span class="s1">'tagline'</span><span class="p">:</span> <span class="s1">'t1'</span>
    <span class="p">})</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s1">'h1'</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">e</span> <span class="o">==</span> <span class="n">g</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">()</span>
<span class="n">e</span><span class="o">.</span><span class="n">blog</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'b2'</span><span class="p">,</span>
    <span class="s1">'tagline'</span><span class="p">:</span> <span class="s1">'t2'</span>
<span class="p">}</span>
<span class="n">e</span><span class="o">.</span><span class="n">headline</span> <span class="o">=</span> <span class="s1">'h2'</span>
<span class="n">e</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div><h2 id="field-data-integrity-checks">Field data integrity checks</h2><p>Djongo automatically validates the value assigned to an EmbeddedField. Integrity criteria (<code>null=True</code> or <code>blank=False</code>) can be applied on the <code>ÈmbeddedField</code> or to the internal fields (<code>CharField</code>)</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ObjectIdField</span><span class="p">()</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DjongoManager</span><span class="p">()</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s1">'h1'</span><span class="p">,</span> <span class="n">blog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">clean_fields</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span>
<span class="c1"># No validation error</span>
</code></pre></div><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ObjectIdField</span><span class="p">()</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DjongoManager</span><span class="p">()</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s1">'h1'</span><span class="p">,</span> <span class="n">blog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">clean_fields</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> 
    <span class="n">ValidationError</span><span class="p">({</span><span class="s1">'blog'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'This field cannot be null.'</span><span class="p">]})</span>
</code></pre></div><h2 id="nesting-embedded-fields">Nesting Embedded Fields</h2><p>An <code>EmbeddedField</code> or <code>ArrayField</code> can be nested inside an <code>EmbeddedField</code>. There is no limitation on the depth of nesting.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">djongo</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Tagline</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">subtitle</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span><span class="n">model_container</span><span class="o">=</span><span class="n">Tagline</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ObjectIdField</span><span class="p">()</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span>
    <span class="p">)</span>

    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DjongoManager</span><span class="p">()</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">headline</span><span class="o">=</span><span class="s1">'h1'</span><span class="p">,</span>
    <span class="n">blog</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'b1'</span><span class="p">,</span>
        <span class="s1">'tagline'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'title'</span><span class="p">:</span> <span class="s1">'Tagline Title'</span>
            <span class="s1">'subtitle'</span><span class="p">:</span> <span class="s1">'Tagline Subtitle'</span>
        <span class="p">}</span>
    <span class="p">})</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s1">'h1'</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">e</span> <span class="o">==</span> <span class="n">g</span>
</code></pre></div><h2 id="embedded-form">Embedded Form</h2><p>While creating a Form for <a href="https://docs.djangoproject.com/en/dev/topics/forms/modelforms/">the ModelForm</a>, the embedded forms <strong>are automatically generated</strong>. Multiple embedded forms get automatically generated when the Model contains an array of embedded models. However, you can still override this by specifying the <code>model_form_class</code> argument in the <code>EmbeddedField</code>.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">djongo</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">BlogForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Blog</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">'name'</span><span class="p">,</span> <span class="s1">'tagline'</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span><span class="p">,</span>
        <span class="n">model_form_class</span><span class="o">=</span><span class="n">BlogForm</span>
    <span class="p">)</span>

    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DjongoManager</span><span class="p">()</span>
</code></pre></div><h2 id="querying-embedded-fields">Querying Embedded fields</h2><p>To query all BlogPost with content made by authors whose name startswith <em>Beatles</em> use the following query:
</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__startswith</span><span class="o">=</span><span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Beatles'</span><span class="p">})</span>
</code></pre></div><p>Internally Djongo converts this query (for BlogPost collection) to the form:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="nb">filter</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'blog.name'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">'$regex'</span><span class="p">:</span> <span class="s1">'^Beatles.*$'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>For querying nested embedded fields provide the appropriate dictionary value</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__startswith</span><span class="o">=</span><span class="p">{</span><span class="s1">'tagline'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'subtitle'</span><span class="p">:</span> <span class="s1">'Artist'</span><span class="p">})</span>
</code></pre></div><p>Internally Djongo converts this query (for BlogPost collection) to the form:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="nb">filter</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'blog.tagline.subtitle'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'$regex'</span><span class="p">:</span> <span class="s1">'^Artist.*$'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id="using-embeddedfield-in-django-admin">Using EmbeddedField in Django Admin</h2><p>Django Admin is a powerful tool for managing data used in an app. When the models use Djongo relational fields, NoSQL "embedded models" can be created directly from Django Admin. <strong>These fields provide better performance when compared with traditional Django relational fields.</strong></p><p>Django admin can use models to automatically build a site area that can be used to create, view, update, and delete records. This can save a lot of time during development, making it very easy to test the models and get a feel for the right data. Django Admin is already quite well known, but to demonstrate how to use it with Djongo, here is a simple example.</p><p>First define our basic models. In these tutorials, the same example used in the official <a href="https://docs.djangoproject.com/en/2.0/topics/db/queries/">Django documentation</a> is used. The documentation talks about 3 models that interact with each other: <strong>Blog, Author and Entry</strong>. To make the example clearer, few fields from the original models are omitted. </p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">djongo</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="k">class</span> <span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Blog</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">body_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">mod_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Author</span><span class="p">)</span>
    <span class="n">n_comments</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">n_pingbacks</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">headline</span>
</code></pre></div><p>Start with the admin development by <em>registering</em> a model. Register the models defined above in the <code>admin.py</code> file.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Blog</span><span class="p">,</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Entry</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">([</span><span class="n">Blog</span><span class="p">,</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Entry</span><span class="p">])</span>
</code></pre></div><h2 id="data-model">Data Model</h2><p>The <code>Entry</code> model defined in the documentation consists of 3 parts: * 1-to-Many Relationship: A <code>Blog</code> is made up of multiple <code>Entry</code>s’ and each <code>Entry</code> is associated with just <em>one</em><code>Blog</code>. The same entry cannot appear in two <code>Blog</code>s’ and this defines the 1-to-Many relationship. * Many-to-Many Relationship: An <code>Entry</code> can have <em>multiple</em><code>Author</code>s’ and an <code>Author</code> can make multiple <code>Entry</code>s’. This defines the many-to-many relationship for our data model. * Normal data columns.</p><p><strong>An interesting point of note</strong> is that the <code>Blog</code> model consists of just 2 fields. Most of the data is stored in the <code>Entry</code> model.</p><p>So what happens when a user enters a blog? The user wants to view the ‘Beatles blog’. In the project you could probably do:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Beatles Blog'</span><span class="p">)</span>
</code></pre></div><p>Next, to retrieve all entries related to the Beatles blog, follow it up with:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog_id</span><span class="o">=</span><span class="n">blog</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div><p>While it is fine to obtain entries in this fashion, you end up <strong>making 2 trips</strong> to the database. For SQL based backend this is not the most efficient way. The number of trips can be reduced to one. Django makes the query more efficient:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__name</span><span class="o">=</span><span class="s1">'Beatles Blog'</span><span class="p">)</span>
</code></pre></div><p>This query will hit the database just once. All entries associated with a <code>Blog</code> having the name ‘Beatles Blog’ will be retrieved. However, this query generates a SQL JOIN. <strong>JOINs are much slower when compared to single table lookups</strong>.</p><p>Since a <code>Blog</code> model shares a 1-to-many relationship with <code>Entry</code> the <code>Entry</code> model can be written as:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">blog_tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">body_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">mod_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Author</span><span class="p">)</span>
    <span class="n">n_comments</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">n_pingbacks</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">headline</span>
</code></pre></div><p>The <code>Blog</code> fields have been inserted into the <code>Entry</code> model. With this new data model the query changes to:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog_name</span><span class="o">=</span><span class="s1">'Beatles Blog'</span><span class="p">)</span>
</code></pre></div><p>There are no JOINs generated with this and queries will be much faster. There is data duplication, but only if the backend database does not use data compression.</p><p>Using compression to mitigate data duplication is fine but take a look at the Entry model, it has 10 columns and is getting unmanageable.</p><h2 id="the-embedded-data-model">The Embedded Data Model</h2><p>A <code>Blog</code> contains a <code>name</code> and a <code>tagline</code>. An <code>Entry</code> contains details of the <code>Blog</code>, the <code>Authors</code>, <code>body_text</code> and some <code>Meta</code> data. To make the <code>Entry</code> model manageable it can be redefined with an <code>EmbeddedField</code>.</p><p>Embedded data models should be used when it does not make sense to store a data set as another table in the database and refer to it every time with a foreign key lookup. However, you still want to group the data set in a hierarchical fashion, to isolate its functionality.</p><p>In case you don't plan on using your embedded model as a standalone model (which means it will always be embedded inside a parent model) you should add the <code>class Meta</code> and <code>abstract = True</code> This way Djongo will never register this model as an <a href="https://docs.djangoproject.com/en/dev/topics/db/models/#abstract-base-classes">actual model</a>.</p><p>It is a good practice to <strong>define embedded models as abstract models</strong> and this is <strong>strongly recommended</strong>.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">djongo</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">MetaData</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">mod_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">n_pingbacks</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">meta_data</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">MetaData</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">body_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Author</span><span class="p">)</span>
    <span class="n">n_comments</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">headline</span>
</code></pre></div><p>To display the embedded models in Django Admin, a <code>Form</code> for the embedded fields is required. Since the embedded field is an abstract model, the form is easily created by using a <code>ModelForm</code>. The <code>BlogForm</code> defines <code>Blog</code> as the model with <code>name</code> and <code>tagline</code> as the form fields. </p><p>If you do not specify a <code>ModelForm</code> for your embedded models, and pass it using the <code>model_form_class</code> argument, Djongo will automatically generate a <code>ModelForm</code> for you.</p><p>Register the new models in <code>admin.py</code>. </p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">.embedded_models</span> <span class="kn">import</span> <span class="n">Author</span><span class="p">,</span> <span class="n">Entry</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">([</span><span class="n">Author</span><span class="p">,</span> <span class="n">Entry</span><span class="p">])</span>
</code></pre></div><p>The number of fields in the <code>Entry</code> model is reduce to 6. Fire up Django Admin to check what is up!</p><p><img alt="Django Admin" src="/assets/images/embedded-admin.png"></p><p>Only the <code>Entry</code> and <code>Author</code> model are registered. I click on <em>Entrys Add</em> and get:</p><p><img alt="Django Admin" src="/assets/images/embedded-nested.png"></p><blockquote><p>The <code>Name</code> and <code>Tagline</code> fields are neatly nested within Blog. <code>Pub date</code><code>Mod date</code><code>N pingbanks</code> and <code>Rating</code> are neatly nested within Meta data.</p></blockquote><p>When a user queries for a blog named ‘Beatles Blog’, the query for filtering an embedded model changes to:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog</span><span class="o">=</span><span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Beatles Blog'</span><span class="p">})</span>
</code></pre></div><p>This query will return all entries having an embedded blog with the name ‘Beatles Blog’. <strong>The query will hit the database just once and there are no JOINs involved.</strong></p></ng-component><!----></div><aside _ngcontent-ng-c3825049082 class="nav-sticky"><nav _ngcontent-ng-c3825049082 class="nav nav-toc"><h3 _ngcontent-ng-c3825049082><i _ngcontent-ng-c3825049082 class="fas fa-file-alt"></i> On This Page</h3><ul _ngcontent-ng-c3825049082><!----></ul></nav></aside></div></div><div _ngcontent-ng-c3552946287 id="footer" class="page__footer"><footer _ngcontent-ng-c3552946287><aside _ngcontent-ng-c3552946287 class="l-fixed-notice cookie-notice"><p _ngcontent-ng-c3552946287>We use cookies to enhance user experience. You consent to their usage by browsing this site. <button _ngcontent-ng-c3552946287 id="cookie-accept" class="btn btn--success" jsaction="click:;">Accept</button></p></aside><div _ngcontent-ng-c3552946287 class="page__footer-copyright">© 2025 Doableware AB.</div></footer></div></div></app-body></ng-component><!----></app-root>
<!--<script src="/assets/js/main.min.js"></script>-->
<script>
  window.ga = function () {
    ga.q.push(arguments)
  };
  ga.q = [];
  ga.l = +new Date;
  ga('create', 'UA-75159067-1', 'auto');
  ga('set', 'anonymizeIp', false);
  ga('send', 'pageview')
</script>
<script src="https://www.google-analytics.com/analytics.js" async></script>
<link rel="modulepreload" href="chunk-27PYSS5C.js"><script src="polyfills-EONH2QZO.js" type="module"></script><script src="main-FKZ2IASU.js" type="module"></script>
<script id="ng-state" type="application/json">{"__nghData__":[{"t":{"10":"t0"},"c":{"10":[{"i":"t0","r":1,"x":5}]}},{"t":{"0":"t16","2":"t17","3":"t18"},"c":{"0":[],"2":[{"i":"t17","r":2,"c":{"0":[{"i":"t16","r":1}]}}],"3":[]}},{},{"n":{"1":"0f2nf","4":"3fn"},"t":{"7":"t19","21":"t21"},"c":{"7":[{"i":"t19","r":1,"t":{"5":"t20"},"c":{"5":[{"i":"t20","r":1,"x":6}]}},{"i":"t19","r":1,"t":{"5":"t20"},"c":{"5":[{"i":"t20","r":1,"x":5}]}},{"i":"t19","r":1,"t":{"5":"t20"},"c":{"5":[{"i":"t20","r":1,"x":2}]}}],"13":[{"i":"c238907409","r":1}],"21":[]}},{"c":{"0":[{"i":"c3825049082","r":1}]}}]}</script></body></html>